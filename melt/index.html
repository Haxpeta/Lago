<!DOCTYPE html>
<html lang="cn">
  <head><meta name="generator" content="Hexo 3.8.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="melt">













  <link rel="alternate" href="/Lago/atom.xml" title="Lago">




  <link rel="shortcut icon" type="image/x-icon" href="/Lago/favicon.ico?v=2.10.2">



<link rel="canonical" href="https://memorytoco.github.io/Lago/melt/">



  <link rel="stylesheet" type="text/css" href="/Lago/lib/fancybox/jquery.fancybox.css">




  <link rel="stylesheet" type="text/css" href="/Lago/lib/nprogress/nprogress.min.css">



<link rel="stylesheet" type="text/css" href="/Lago/css/style.css?v=2.10.2">



  



  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":true};
</script>

    <title> melt - Lago </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/Lago/." class="logo">Lago</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/Lago/">
        <li class="mobile-menu-item">
          
          
            首页
          
        </li>
      </a>
    
      <a href="/Lago/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
      <a href="/Lago/tags">
        <li class="mobile-menu-item">
          
          
            标签
          
        </li>
      </a>
    
      <a href="/Lago/categories">
        <li class="mobile-menu-item">
          
          
            分类
          
        </li>
      </a>
    
      <a href="/Lago/about">
        <li class="mobile-menu-item">
          
          
            关于
          
        </li>
      </a>
    
      <a href="/Lago/melt">
        <li class="mobile-menu-item">
          
          
            Melt
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/Lago/." class="logo">Lago</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/Lago/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/Lago/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/Lago/tags">
            
            
              标签
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/Lago/categories">
            
            
              分类
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/Lago/about">
            
            
              关于
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/Lago/melt">
            
            
              Melt
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  <article class="post">
    <div class="post-content">
      <h1 id="关于-melt-近期的信息"><a href="#关于-melt-近期的信息" class="headerlink" title="关于 melt 近期的信息"></a>关于 melt 近期的信息</h1><ul>
<li>更新时间 : <code>2019-3-10</code></li>
<li><code>melt</code> 最新开发信息: <code>v 0.0.1</code> 重新定义版本号, 重新构思基本组件. 重新决定 melt 工作方式.</li>
</ul>
<blockquote>
<p>以下的内容可能受限于我个人的知识面和经验让你看得很尬, 所以如果有任何好的建议, 欢迎通过邮件与我交流.</p>
</blockquote>
<h2 id="melt-工作流程"><a href="#melt-工作流程" class="headerlink" title="melt 工作流程"></a>melt 工作流程</h2><p>首先<strong>parser</strong>读取源文件,得到初始数据,将其存于自己的 resr 域中.<br>根据具体的设计可能对初始的原<code>post</code>进行修改与提炼.</p>
<p>然后交由<strong>post</strong>对数据进一步处理,得到完整的 <code>post sxml</code> 数据以及相关的原始文件信息<br>以及关于<strong>post</strong>的一些属性, 类似 <em>tag, categories</em> 这类.<br>得到<strong>post</strong>之后, 这个就算最初始的处理了. 对于后面的过程来讲, 最小的数据单元就是这个 <strong>post</strong> 了.</p>
<blockquote>
<p><strong>post</strong> 包含了由解析器处理后的<code>sxml</code>数据以及相关的文件,post 属性</p>
</blockquote>
<p>在得到一系列或者单个<strong>post</strong>之后,就会根据<strong>site</strong>的设定用每个独立的<strong>page</strong><br>单元调用依据对应不同部分的<strong>renderer</strong>来对原始<code>sxml</code>进行渲染和组装处理.<br>这时候可能是输入诸如 post 时间, post 分类, 生成相关的<em>url</em>这类数据的阶段.<br>组装完成后的数据会存放在<strong>page</strong>的<em>cont</em>域中.</p>
<p>最后最后, 我们可能得到了一系列或者单个<strong>page</strong>原数据.<br>这时最小的数据单元就是一个个或者单个<strong>page</strong>了.<br>依据<strong>site</strong>的设定一个个的输出到对应的目标位置. 在这期间是否会有什么其他的操作不得而<br>知, 但是基于<code>sxml</code>的特性, 依旧存在着继续处理的可能性.(因为 sxml 和一个 lisp 代码没有本质的区别,只是把它当成数据来处理了,这也是当初决定拿 scheme 来写这个东西的一个原因)</p>
<p>结尾时, 再把一些网站的资源文件搬到对应的地方去, 由<strong>asset</strong>来处理.</p>
<p>至此, 整个建站过程完成. 下面针对一些细节再次讨论一下:</p>
<ul>
<li>整个过程似乎没有提到一些特殊的页面, 比如<strong>categories</strong>和最开始的<strong>index</strong>页面, 这些怎么生成<blockquote>
<p>现在补充的一个信息就是, 以上的工作流程是<strong>命令</strong> <code>build</code> 的全部工作流程.<br>这里除了<strong>post</strong>可能会被写死专门处理有关 post 的事情, 其它的<strong>page</strong>,<strong>parser</strong><br>和<strong>site</strong>等等都是一些个带有特定意义的域的数据结构罢了. 具体的处理流程会由<strong>命令</strong>来<br>决定. 针对这些特殊的页面可以专门为其写入一个原始 sxml 文件中, 然后依旧交给<strong>parser</strong><br>和<strong>page</strong>进行处理, 根据对应的配置输出到相应的位置.</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>同样的, 对于<strong>atom</strong>格式的 RSS,可能的订阅服务等, 都可以交由那两个来处理.</p>
</blockquote>
<blockquote>
<p>所有的<strong>parser</strong>都是针对文件来说的, <code>flax</code>会针对不同格式的文件调用不同<strong>parser</strong><br>从而得到相对应输出文件.<br>所有的 post 都是针对<strong>parser</strong>来讲的. 这里我其实也没有把 post 写死, 他也不一定只是针对<br>post 来说的, 之后或许可以改个名.<br>然而<strong>page</strong>可能是对<strong>post</strong>也可能是对于<strong>parser</strong>来说的. <strong>page</strong> 是网站的最小<br>构成单元.</p>
</blockquote>
<ul>
<li>我看着你说的东西不仅模糊, 而且我似乎也没有看到什么让我兴奋的点阿<blockquote>
<p>这样的, 由于<code>flax</code>还在构建中, 所以以上的说明也只是我目前的想法, 随时都有可能更改.<br>我也要一个具体的思路才能继续构建. 具体的流程也会慢慢完善细致.</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>从我的角度来看, 我觉得兴奋的点还是存在的. <code>flax</code> 目前的目标是定义一套构建个人博客的<br>工具, 并且一直在努力减少原先代码的存在感. 意思就是让用户能够定义几乎所有的东西.<br>包括写博客时的工作目录的结构, <code>flax</code>的内置命令. 这些不需要修改<code>flax</code>的源码就能做到.<br>这个东西其实是很有限的, 但是如果把想象力交给用户的话, 一切都不一样了.</p>
</blockquote>
<blockquote>
<p>目前<code>build</code>命令其实做的事情就是执行用户的<code>.scm</code>文件(对, 就是执行), 然后用户在这个<br>文件里能够访问所有的实现特性以及引入库. 主题什么的就是一个程序. 这个程序可能会替代原先<br>默认的一些设置.</p>
</blockquote>
<blockquote>
<p>然后, 用户可以自定义<code>melt</code>的二级命令, 比如达到<code>Hexo new &quot;blog name&quot;</code>这种效果.</p>
</blockquote>
<hr>
<hr>
<h2 id="melt-目前的困难"><a href="#melt-目前的困难" class="headerlink" title="melt 目前的困难"></a>melt 目前的困难</h2><ul>
<li><p>[x] 考虑加入缓存系统, 也就是一个全局的数据文件, 这个用来处理诸如 index 页面 post 预览顺序的问题</p>
<blockquote>
<p>是不是要加还是有待探索, 个人认为最好元数据不会依赖于除了原 post 之外的一些数据<br>也就是说, 所有的关于 post 的信息都只从原文件获取</p>
</blockquote>
<p>引入<code>.melt</code>配置文件, 提供临时文件存储地点</p>
</li>
<li><p>markdown 的支持</p>
<blockquote>
<p>现在最麻烦的可能就是这个解析器了…</p>
</blockquote>
</li>
<li>内部的 url 连接问题, 以及在写 post 时对于其它 post 或者资源文件引用的问题</li>
<li><p>单个 post 或者单个页面的资源位置存放问题</p>
</li>
<li><p>[x] 插件系统</p>
<blockquote>
<p>从工作流程上来看, 所谓的插件可能不是特别需要. 直接开箱即用的定义好的主题可能就够了.<br>而这个主题本身就是一个程序, 它的配置选项,对应用户的额外需求似乎不需要我来插手.</p>
</blockquote>
<p>将每个部件定义为数据, 用户提供这种数据(也就是不同类部件的不同功能), 以供内部调用. 支持自定义命令. subcommand 特性支持.</p>
</li>
</ul>
<h2 id="melt-预备特性"><a href="#melt-预备特性" class="headerlink" title="melt 预备特性"></a>melt 预备特性</h2><ul>
<li>更加智能, 机智的知道哪些需要删除哪些可以添加<blockquote>
<p>它是半个活的程序…<br>目前好像<code>Hexo</code>做到了这一点</p>
</blockquote>
</li>
<li>加大其适用性</li>
</ul>
<hr>
<hr>
<h2 id="melt-改进计划以及详细介绍"><a href="#melt-改进计划以及详细介绍" class="headerlink" title="melt 改进计划以及详细介绍"></a>melt 改进计划以及详细介绍</h2><p>目前 melt 的目标是能够最大限度的给予用户自由并且提供充足的 api 来减轻<br>用户的负担.</p>
<h3 id="parser"><a href="#parser" class="headerlink" title="parser"></a>parser</h3><p>定义为一个前端处理单元, 一个处理单元就对应一个类型的文件. 它的动作和可设置的选项由它自己决定.</p>
<blockquote>
<p>用于读取原 post 并把它转化成 sxml<br>parser 是一个存有编译程序的数据, 由 parse 调用. 在整个处理过程之前存在</p>
</blockquote>
<p>定义:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type ==&gt; 类别,用于识别源文件.</span><br><span class="line">proc ==&gt; 用于处理源文件,提取原始信息,将其转化成 sxml.</span><br><span class="line">refp ==&gt; 精炼函数,处理源文件,更新它的信息.</span><br></pre></td></tr></table></figure>
<p>其本身可能会有多段的分析组合, 这些都由它自己决定.</p>
<h3 id="post"><a href="#post" class="headerlink" title="post"></a>post</h3><blockquote>
<p>现在就是代表了基本的源数据, 不只是表示一个写的文章或者什么, 由 markdown 扩展</p>
</blockquote>
<p>定义:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">meta ==&gt; 原始处理文件的信息,不是 post 的信息. 比如修改时间,具体的路径文件名.</span><br><span class="line">attr (属性) ==&gt; 在文件头解析得到的属性, 比如文章名字</span><br><span class="line">cont ==&gt; 处理后的 post 内容</span><br></pre></td></tr></table></figure>
<p>此时 post 和 parser 组成了整个前端,完成一个源文件的分析更新工作.</p>
<h3 id="renderer"><a href="#renderer" class="headerlink" title="renderer"></a>renderer</h3><blockquote>
<p>渲染, 针对特定的 page 进行特定的处理,对 post 的数据进行封装<br>由 page 调用, 根据不同的组件进行处理.</p>
</blockquote>
<p>renderer 定义组件, page 调用.</p>
<p>定义:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type ==&gt; 需要处理的组件的识别符</span><br><span class="line">proc ==&gt; 具体的处理函数,由 process 组成,可能嵌套</span><br><span class="line">data ==&gt; 暂时需要的存储数据, 使用data结构</span><br></pre></td></tr></table></figure>
<h3 id="page"><a href="#page" class="headerlink" title="page"></a>page</h3><blockquote>
<p>用于将每个 post 渲染后写入目标文件</p>
</blockquote>
<p>定义:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">meta ==&gt; 包括识别名和可能的page属性</span><br><span class="line">cont ==&gt; 页面模板</span><br><span class="line">comt ==&gt; 页面的组件, 在使用前需要在这里注册它的行为, 也就是说这是一个函数</span><br></pre></td></tr></table></figure>
<p>页面渲染首先是渲染部件,然后再组合,comt 由 render 来渲染,最后写进模板中</p>
<h3 id="site-对博客的整体配置"><a href="#site-对博客的整体配置" class="headerlink" title="site 对博客的整体配置"></a>site 对博客的整体配置</h3><p>可能的域:</p>
<ul>
<li>layout ==&gt; 网站布局, 是具体的文件集对网站组成部分的对应关系.</li>
<li>comt ==&gt; 组件,比如个人介绍页, 资源页等.</li>
<li>attr ==&gt; 网站的相关属性, 比如域名, 托管工具等等</li>
</ul>
<h3 id="hook-系统和-trigger-系统"><a href="#hook-系统和-trigger-系统" class="headerlink" title="hook 系统和 trigger 系统"></a>hook 系统和 trigger 系统</h3><p>这个似乎可以使用<code>call/cc</code>来实现, 正在绞尽脑汁中.</p>
<h3 id="插件系统"><a href="#插件系统" class="headerlink" title="插件系统"></a>插件系统</h3><blockquote>
<p>开发额外的插件, 提供额外的命令, 不一定只有 build 命令,目前不会多想</p>
</blockquote>
<h3 id="melt-文件夹"><a href="#melt-文件夹" class="headerlink" title=".melt 文件夹"></a>.melt 文件夹</h3><p>这里面就是整个的真身. 在使用 init 命令时, 会生成这个文件. 里面的有<code>settings.scm</code>定义 melt 配置, 然后由这个定义工作文件夹的布局, 提供命令什么的.</p>
<h2 id="急需解决的问题"><a href="#急需解决的问题" class="headerlink" title="急需解决的问题"></a>急需解决的问题</h2><ul>
<li style="list-style: none"><input type="checkbox"> markdown 的支持</li>
<li style="list-style: none"><input type="checkbox" checked> 内部的 url 连接问题以及单个 post 或者单个页面的资源位置存放问题</li>
</ul>

    </div>
  </article>

          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:memorytoco@gmail.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/memorytoco" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    
      <a href="/Lago/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>



<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
    
    2019

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Memorytoco</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  

  



    
  



  
  





  
    <script type="text/javascript" src="/Lago/lib/jquery/jquery.min.js"></script>
  

  
    <script type="text/javascript" src="/Lago/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/Lago/lib/fancybox/jquery.fancybox.pack.js"></script>
  

  
    <script type="text/javascript" src="/Lago/lib/pjax/jquery.pjax.min.js"></script>
  

  
    <script type="text/javascript" src="/Lago/lib/nprogress/nprogress.min.js"></script>
  


    <script type="text/javascript" src="/Lago/js/src/even.js?v=2.10.2"></script>

  </body>
</html>
